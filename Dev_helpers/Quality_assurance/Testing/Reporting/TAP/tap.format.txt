
       
   TAP  
       



ALTERNATIVES ==>                  #  - Jasmine:
                                  #     - own reporters
                                  #     - available: min, normal, spec, HTML, TAP, JUnit, NUnit, AppVeyor, TeamCity
                                  #  - Mocha:
                                  #     - own reporters
                                  #     - available: min, normal, spec, fun, HTML, Markdown, JSON, TAP, XUnit
                                  #  - Jest:
                                  #     - own reporters

VERSION ==>                       #13
                                13#13-only is marked like this
                                 ##Non-standard

GOAL ==>                          #Test reporting format
                                  #Streaming-friendly
                                  #Fairly generic and easy to parse

MIME TYPE ==>                     #application/tap

UNKNOWN LINES ==>                 #Are allowed but ignored (for future compatibility)


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            SYNTAX             :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


TAP version NUM                   #Required since version 13

# COMMENT                         #

1..NUM [# DIRECTIVE [COMMENT]]    #"plan": this file should have NUM assertions
                                  #Must be at beginning or end

# TEST_TITLE                     ##Beginning of a test (i.e. a group of assertions)

[not] ok [INDEX] [ASSERT_TITLE]   #Single assertion
 [# DIRECTIVE [COMMENT]]          #INDEX is incrementing from 1 for each assertion (def: auto-incrementing)
                                  #ASSERT_TITLE should not start with dot
                                  #DIRECTIVE can be:
                                  #  - SKIP: tested but skipped (should be ok)
                                  #  - TODO: not tested yet (should be not ok, however be treated as ok)
  ---                             #Error properties, as YAML
  VAR: VAL                       ##Often used:
  ...                            ##  - operator STR: assertion function
                                 ##  - expected|actual VAL
                                 ##     - sometimes called wanted|found
                                 ##  - message|Failure STR: error message
                                 ##  - stack STR:
                                 ##     - multiline starting next line
                                 ##     - must be last property
                                 ##     - each line must be "at: NAME (PATH:LINE:COL)"
                                 ##  - severity 'warn|error|fail'
                                 ##  - data OBJ

NESTED TESTS ==>                 ##E.g. when using describe()
                                 ##Have same structure as above except no plan nor pragma
                                 ##Parent assertion is the describe()
                                 ##TEST_TITLE sometimes prepended 'Subtest: '
                                 ##There are several syntaxes:
                                 ##  - "not buffered": indented, before their parent assertion
                                 ##  - "buffered": indented, after their parent assertion, enclosed with {}
                                 ##     [not] ok ... {
                                 ##       CHILD
                                 ##     }
                                 ##
                                 ##     or
                                 ##
                                 ##     [not] ok ...
                                 ##     ---
                                 ##     [YAML error props]
                                 ##     ...
                                 ##     {
                                 ##       CHILD
                                 ##     }

# tests: NUM
# pass: NUM
# fail: NUM                      ##At end of file. In that order.
# ok                             ##Counts the number of assertions (not tests)

Bail out! [COMMENT]               #Testing was interrupted

pragma +VAR|-VAR                 ##Parser-specific directive


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:           PRODUCERS           :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


MOCHA ==>                         #  - no TAP version
                                  #  - no TEST_TITLE
                                  #  - plan
                                  #  - assertions:
                                  #     - ASSERT_TITLE contains describe() and test title (i.e. no CHILD)
                                  #     - can use # SKIP (no # TODO)
                                  #     - YAML error properties: ERROR.toString() + ERROR.stack as is
                                  #  - # tests|pass|fail NUM (but not # ok)
                                  #  - no Bail out!

JASMINE ==>                       #  - TAP version 13
                                  #  - no TEST_TITLE
                                  #  - plan at the end
                                  #  - assertions:
                                  #     - ASSERT_TITLE contains describe() and test title (i.e. no CHILD)
                                  #     - can use # SKIP (no # TODO)
                                  #     - YAML error properties: ERROR.toString() + ERROR.stack as Failure property
                                  #  - # NUM spec, NUM failure, NUM skipped, NUM disabled in NUMs
                                  #  - no Bail out!

JEST-JSON-TO-TAP ==>              #  - no TAP version
                                  #  - plan
                                  #  - no TEST_TITLE
                                  #  - assertions:
                                  #     - ASSERT_TITLE (no CHILD)
                                  #     - can use # SKIP (no # TODO)
                                  #     - error messages added as # COMMENTs afterwards
                                  #  - # tests|pass|fail NUM (but not # ok)
                                  #  - no Bail out!

JEST-TAP-REPORTER ==>             #  - no TAP version
                                  #  - plan
                                  #  - no TEST_TITLE
                                  #  - assertions:
                                  #     - ASSERT_TITLE (no CHILD)
                                  #     - can use # SKIP (no # TODO)
                                  #     - YAML error properties:
                                  #        - Received|Expected STR
                                  #        - Difference STR
                                  #        - raw STR for ERROR.toString() + ERROR.stack
                                  #  - no # tests|pass|fail|ok
                                  #  - no Bail out!

ESLINT ==>                        #  - TAP version 13
                                  #  - plan
                                  #  - no TEST_TITLE
                                  #  - assertions:
                                  #     - ASSERT_TITLE is path (no CHILD)
                                  #     - no # SKIP|TODO
                                  #     - YAML error properties ERROR:
                                  #        - message STR
                                  #        - severity 'error|warning'
                                  #        - data: line|column NUM, ruleId 'NAME'
                                  #        - messages ERROR_ARR (same as above)
                                  #  - no # tests|pass|fail|ok
                                  #  - no Bail out!

TAPE ==>                          #  (beginning)
                                  #  - TAP version 13
                                  #  (TAPE.test())
                                  #  - # TEST_TITLE
                                  #  (TOPTS.skip)
                                  #  - # SKIP TEST_TITLE, then skipped from output
                                  #  (TAPE.skip())
                                  #  - skipped from output
                                  #  (TEST.skip())
                                  #  - [not] ok INDEX ASSERT_TITLE # SKIP
                                  #  (assertions)
                                  #  - [not] ok INDEX ASSERT_TITLE
                                  #  - YAML error props: operator, expected|actual, at|stack
                                  #  (TEST.comment())
                                  #  - # COMMENT
                                  #  (end)
                                  #  - plan 1..NUM (automatically done even without TEST.plan())
                                  #  - # tests|pass|fail NUM
                                  #  - # ok
